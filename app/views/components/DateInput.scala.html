@*
 * Copyright 2024 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@this(govukDateInput: GovukDateInput)

@(name: String, form: Form[_], wholeFormError: Boolean, legend: Option[Legend], hint: Option[Hint])(implicit messages: Messages)

@inputErrorClass(key: String) = @{
    val inputSpecificError = form.errors.contains(FormError(key, List(s"error.date.$key")))
    if (wholeFormError || inputSpecificError) "govuk-input--error" else ""
}
@errorHtml(errors: Seq[FormError]) = {
    @errors.map { error =>
        <span id=@{s"${error.key}-error"}>@messages(error.message, error.args: _*)</span><br>
    }
}
@errorMessage = @{
    if(form.errors.isEmpty) {
        None
    } else {
        Some(ErrorMessage(content = HtmlContent(errorHtml(form.errors))))
    }
}

@govukDateInput(
    DateInput(
        id = "construction-start-date",
        fieldset = Some(Fieldset(
            legend = legend
        )),
        hint = hint,
        items = Seq(
            InputItem(
                classes = s"govuk-input--width-2 ${inputErrorClass("day")}",
                name = "day",
                label = Some(messages("site.day")),
                value = form("day").value,
                id = "day"
            ),
            InputItem(
                classes = s"govuk-input--width-2 ${inputErrorClass("month")}",
                name = "month",
                label = Some(messages("site.month")),
                value = form("month").value,
                id = "month"
            ),
            InputItem(
                classes = s"govuk-input--width-4 ${inputErrorClass("year")}",
                name = "year",
                label = Some(messages("site.year")),
                value = form("year").value,
                id = "year"
            )
        ),
        errorMessage = errorMessage
    )
)
